!(function(t,e){'object'==typeof exports&&'object'==typeof module?module.exports=e():'function'==typeof define&&define.amd?define([],e):'object'==typeof exports?exports.Compress=e():t.Compress=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports};var n={};return e.m=t,e.c=n,e.p='',e(0)}([function(t,e,n){var i,a,r;!function(o,u){a=[t,n(1),n(2),n(3),n(4),n(5),n(6)],i=u,r='function'==typeof i?i.apply(e,a):i,!(void 0!==r&&(t.exports=r))}(this,function(t,e,n,p,v,g,h){'use strict';function i(t){return t&&t.__esModule?t:{default:t}};function s(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n};return Array.from(t)};function m(t,e){if(!(t instanceof e))throw new TypeError('Cannot call a class as a function')};var a=i(e),r=i(n),l=i(p),o=i(v),c=i(g),u=i(h),d=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,'value'in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}};return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),f=function(){function t(){m(this,t)};return d(t,[{key:'attach',value:function(t,e){var n=this;return new Promise(function(i,r){var a=document.querySelector(t);a.setAttribute('accept','image/*'),a.addEventListener('change',function(t){var r=n.compress([].concat(s(t.target.files)),e);i(r)},!1)})}},{key:'compress',value:function(t,e){function i(t,e){var n=new c.default(e);return n.start=window.performance.now(),n.alt=t.name,n.ext=t.type,n.startSize=t.size,u.default.orientation(t).then(function(e){return n.orientation=e,l.default.load(t)}).then(s(n))};function s(t){return function(e){return o.default.load(e).then(function(e){if(t.startWidth=e.naturalWidth,t.startHeight=e.naturalHeight,t.resize){var n=o.default.resize(t.maxWidth,t.maxHeight)(e.naturalWidth,e.naturalHeight),i=n.width,a=n.height;t.endWidth=i,t.endHeight=a}
else t.endWidth=e.naturalWidth,t.endHeight=e.naturalHeight;return r.default.imageToCanvas(t.endWidth,t.endHeight,t.orientation)(e)}).then(function(e){return t.iterations=1,t.base64prefix=a.default.prefix(t.ext),n(e,t.startSize,t.quality,t.size,t.minQuality,t.iterations)}).then(function(e){return t.finalSize=a.default.size(e),a.default.data(e)}).then(function(e){t.end=window.performance.now();var n=t.end-t.start;return{data:e,prefix:t.base64prefix,elapsedTimeInSeconds:n/1e3,alt:t.alt,initialSizeInMb:r.default.size(t.startSize).MB,endSizeInMb:r.default.size(t.finalSize).MB,ext:t.ext,quality:t.quality,endWidthInPx:t.endWidth,endHeightInPx:t.endHeight,initialWidthInPx:t.startWidth,initialHeightInPx:t.startHeight,sizeReducedInPercent:(t.startSize-t.finalSize)/t.startSize*100,iterations:t.iterations}})}};function n(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments[3],u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments[5],f=r.default.canvasToBase64(t,i),d=a.default.size(f);return s+=1,d>o?n(t,d,i-.1,o,u,s):i>u?n(t,d,i-.1,o,u,s):i<.5?f:f};return Promise.all(t.map(function(t){return i(t,e)}))}}],[{key:'convertBase64ToFile',value:function(t,e){return r.default.base64ToFile(t,e)}}]),t}();t.exports=f})},function(t,e,n){var i,a,r;!function(n,o){a=[e],i=o,r='function'==typeof i?i.apply(e,a):i,!(void 0!==r&&(t.exports=r))}(this,function(t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var e=function(t){var e=t.replace(/^data:image\/\w+;base64,/,'').length;return(e-814)/1.37},n=function(t){return t.split(';')[0].match(/jpeg|png|gif/)[0]},i=function(t){return t.replace(/^data:image\/\w+;base64,/,'')},r=function(t){return'data:'+t+';base64,'};t.default={size:e,mime:n,data:i,prefix:r}})},function(t,e,n){var i,a,r;!function(n,o){a=[e],i=o,r='function'==typeof i?i.apply(e,a):i,!(void 0!==r&&(t.exports=r))}(this,function(t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var e=function(t){for(var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:'image/jpeg',n=window.atob(t),i=[],e=0;e<n.length;e++)i[e]=n.charCodeAt(e);return new window.Blob([new Uint8Array(i)],{type:r})},n=function(t,e,i){var r=document.createElement('canvas'),n=r.getContext('2d');return r.width=t,r.height=e,function(a){if(!i||i>8)return n.drawImage(a,0,0,r.width,r.height),r;switch(i>4&&(r.width=e,r.height=t),i){case 2:n.translate(t,0),n.scale(-1,1);break;case 3:n.translate(t,e),n.rotate(Math.PI);break;case 4:n.translate(0,e),n.scale(1,-1);break;case 5:n.rotate(.5*Math.PI),n.scale(1,-1);break;case 6:n.rotate(.5*Math.PI),n.translate(0,-e);break;case 7:n.rotate(.5*Math.PI),n.translate(t,-e),n.scale(-1,1);break;case 8:n.rotate(-.5*Math.PI),n.translate(-t,0)};return i>4?n.drawImage(a,0,0,r.height,r.width):n.drawImage(a,0,0,r.width,r.height),r}},i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.75,n=t.toDataURL('image/jpeg',e);return n},r=function(t){return{KB:t/1e3,MB:t/1e6}};t.default={base64ToFile:e,imageToCanvas:n,canvasToBase64:i,size:r}})},function(t,e,n){var i,a,r;!function(n,o){a=[e],i=o,r='function'==typeof i?i.apply(e,a):i,!(void 0!==r&&(t.exports=r))}(this,function(t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var e=function(t){return new Promise(function(e,n){var i=new window.FileReader;i.addEventListener('load',function(t){e(t.target.result)},!1),i.addEventListener('error',function(t){n(t)},!1),i.readAsDataURL(t)})};t.default={load:e}})},function(t,e,n){var i,a,r;!function(n,o){a=[e],i=o,r='function'==typeof i?i.apply(e,a):i,!(void 0!==r&&(t.exports=r))}(this,function(t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var e=function(t){return new Promise(function(e,n){var i=new window.Image;i.addEventListener('load',function(){e(i)},!1),i.addEventListener('error',function(t){n(t)},!1),i.src=t})},n=function(t,e){return function(n,i){if(!t&&!e)return{width:n,height:i};var r=Math.min(n,t),a=Math.min(i,e);if(r){var s=n/r,f=i/s;return{width:r,height:f}};var o=i/a,u=n/o;return{width:u,height:a}}};t.default={load:e,resize:n}})},function(t,e,n){var i,a,r;!function(n,o){a=[e],i=o,r='function'==typeof i?i.apply(e,a):i,!(void 0!==r&&(t.exports=r))}(this,function(t){'use strict';function n(t,e){if(!(t instanceof e))throw new TypeError('Cannot call a class as a function')};Object.defineProperty(t,'__esModule',{value:!0});var e=function i(t){var e=t.quality,s=void 0===e?.75:e,r=t.size,f=void 0===r?2:r,a=t.maxWidth,d=void 0===a?1920:a,o=t.maxHeight,l=void 0===o?1920:o,u=t.resize,c=void 0===u||u;n(this,i),this.start=window.performance.now(),this.end=null,this.alt=null,this.ext=null,this.startSize=null,this.startWidth=null,this.startHeight=null,this.size=1e3*f*1e3,this.endSize=null,this.endWidth=null,this.endHeight=null,this.iterations=0,this.base64prefix=null,this.quality=s,this.resize=c,this.maxWidth=d,this.maxHeight=l,this.orientation=1};t.default=e})},function(t,e,n){var i,a,r;!function(n,o){a=[e],i=o,r='function'==typeof i?i.apply(e,a):i,!(void 0!==r&&(t.exports=r))}(this,function(t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var e=function(t){return new Promise(function(e,n){var i=new window.FileReader;i.onload=function(t){var i=new DataView(t.target.result);65496!==i.getUint16(0,!1)&&e(-2);for(var s=i.byteLength,n=2;n<s;){var o=i.getUint16(n,!1);if(n+=2,65505===o){1165519206!==i.getUint32(n+=2,!1)&&e(-1);var a=18761===i.getUint16(n+=6,!1);n+=i.getUint32(n+4,a);var u=i.getUint16(n,a);n+=2;for(var r=0;r<u;r++)274===i.getUint16(n+12*r,a)&&e(i.getUint16(n+12*r+8,a))}
else{if(65280!==(65280&o))break;n+=i.getUint16(n,!1)}};e(-1)},i.readAsArrayBuffer(t.slice(0,65536))})};t.default={orientation:e}})}])}));